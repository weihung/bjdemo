window.__require=function t(e,n,a){function o(i,r){if(!n[i]){if(!e[i]){var l=i.split("/");if(l=l[l.length-1],!e[l]){var s="function"==typeof __require&&__require;if(!r&&s)return s(l,!0);if(c)return c(l,!0);throw new Error("Cannot find module '"+i+"'")}}var u=n[i]={exports:{}};e[i][0].call(u.exports,function(t){return o(e[i][1][t]||t)},u,u.exports,t,e,n,a)}return n[i].exports}for(var c="function"==typeof __require&&__require,i=0;i<a.length;i++)o(a[i]);return o}({Api:[function(t,e,n){"use strict";cc._RF.push(e,"5ba8060fsVLq4GR27vA3rnI","Api");var a=t("Global");e.exports={post:function(t,e){e.token=a.token?a.token:"";var n={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)};return fetch("https://blackjack21.hopto.org/v1/"+t,n).then(function(t){return t.json()})}},cc._RF.pop()},{Global:"Global"}],Bet:[function(t,e,n){"use strict";cc._RF.push(e,"e7be51jipBB35qq8X7MlHOf","Bet");var a=t("../api/Ws"),o=t("Global");cc.Class({extends:cc.Component,properties:{balanceLabel:{default:null,type:cc.Label},amountLabel:{default:null,type:cc.Label},button:cc.Button,bet:cc.Integer},onLoad:function(){this.button.node.on("click",this.callback,this)},callback:function(t){var e=parseInt(this.bet);if(!(o.balance<e)){o.balance=o.balance-e;var n=parseInt(this.amountLabel.string)+e;this.amountLabel.string=n;var c={cmd:"Bet",betAmount:n};a.send(c)}},start:function(){}}),cc._RF.pop()},{"../api/Ws":"Ws",Global:"Global"}],BtnLogin:[function(t,e,n){"use strict";cc._RF.push(e,"672544/yr1DLqZNjbUZB1/+","BtnLogin");var a=t("../api/Api"),o=t("Global");cc.Class({extends:cc.Component,properties:{username:{default:null,type:cc.EditBox},password:{default:null,type:cc.EditBox},button:cc.Button},onLoad:function(){this.button.node.on("click",this.callback,this)},callback:function(t){t.detail;var e={username:this.username.string,password:this.password.string};a.post("login",e).then(function(t){200==t.code&&(o.token=t.data.token,cc.director.loadScene("table"))}).catch(function(t){console.log(t)})},start:function(){}}),cc._RF.pop()},{"../api/Api":"Api",Global:"Global"}],BtnRegister:[function(t,e,n){"use strict";cc._RF.push(e,"e8bc1ANtv1JGLuBA2ofuptw","BtnRegister");var a=t("../api/Api"),o=t("Global");cc.Class({extends:cc.Component,properties:{username:{default:null,type:cc.EditBox},password:{default:null,type:cc.EditBox},button:cc.Button},onLoad:function(){this.button.node.on("click",this.callback,this)},callback:function(t){t.detail;var e={username:this.username.string,password:this.password.string};a.post("register",e).then(function(t){200==t.code&&(o.token=t.data.token,cc.director.loadScene("table"))}).catch(function(t){console.log(t)})},start:function(){}}),cc._RF.pop()},{"../api/Api":"Api",Global:"Global"}],CardPic:[function(t,e,n){"use strict";cc._RF.push(e,"679e4uEbBJGdYeVm1r3XJMv","CardPic"),cc.Class({extends:cc.Component,properties:{point:cc.Label,suit:cc.Sprite,mainPic:cc.Sprite,cardBG:cc.Sprite,redTextColor:cc.Color.WHITE,blackTextColor:cc.Color.WHITE,texFrontBG:cc.SpriteFrame,texBackBG:cc.SpriteFrame,texFaces:{default:[],type:cc.SpriteFrame},texSuitBig:{default:[],type:cc.SpriteFrame},texSuitSmall:{default:[],type:cc.SpriteFrame}},init:function(t){var e=t.point>10;this.mainPic.spriteFrame=e?this.texFaces[t.point-10-1]:this.texSuitBig[t.suit],this.point.string=t.pointName,t.isRedSuit?this.point.node.color=this.redTextColor:this.point.node.color=this.blackTextColor,this.suit.spriteFrame=this.texSuitSmall[t.suit]},reveal:function(t){this.point.node.active=t,this.suit.node.active=t,this.mainPic.node.active=t,this.cardBG.spriteFrame=t?this.texFrontBG:this.texBackBG}}),cc._RF.pop()},{}],Card:[function(t,e,n){"use strict";cc._RF.push(e,"ecd42aIDKJEu48PnoPuwXKn","Card");var a=t("../api/Ws"),o=t("Global"),c={H:1,D:3,S:0,C:2},i=["","A","2","3","4","5","6","7","8","9","10","J","Q","K"];cc.Class({extends:cc.Component,properties:{cardPrefab:cc.Prefab,playerAnchors:{default:[],type:cc.Node},bankerAnchor:cc.Node},onLoad:function(){var t=this;o.playerCards=[[],[],[],[],[]],o.bankerCards=[],a.on("Deal",function(e){1===e.status&&(e.player<0?o.bankerCards.push(e.card):o.playerCards[e.player].push(e.card),t.drawPlayerCard(),t.drawBankerCard())}),a.on("Result",function(e){1===e.status&&(e.result.forEach(function(t){t.player>=0?o.playerCards[t.player]=t.cards:o.bankerCards=t.cards}),t.drawPlayerCard(),t.drawBankerCard())})},drawPlayerCard:function(){for(var t=0;t<o.playerCards.length;t++){var e={point:0,pointName:1,isRedSuit:1,suit:0};this.playerAnchors[t].removeAllChildren();for(var n=0;n<o.playerCards[t].length;n++){var a=o.playerCards[t][n];if("*"!=a){var r=a.substring(0,1),l=parseInt(a.substring(1));e={point:l,pointName:i[l],isRedSuit:c[r]%2==1,suit:c[r]}}var s=cc.instantiate(this.cardPrefab);this.playerAnchors[t].addChild(s),s.position=cc.v2(20*n,-25*n);var u=s.getComponent("CardPic");u.init(e),u.reveal("*"!=a)}}},drawBankerCard:function(){var t={point:0,pointName:1,isRedSuit:1,suit:0};this.bankerAnchor.removeAllChildren();for(var e=0;e<o.bankerCards.length;e++){var n=o.bankerCards[e];if("*"!=n){var a=n.substring(0,1),r=parseInt(n.substring(1));t={point:r,pointName:i[r],isRedSuit:c[a]%2==1,suit:c[a]}}var l=cc.instantiate(this.cardPrefab);this.bankerAnchor.addChild(l),l.position=cc.v2(50*e,0);var s=l.getComponent("CardPic");s.init(t),s.reveal("*"!=n)}},update:function(t){}}),cc._RF.pop()},{"../api/Ws":"Ws",Global:"Global"}],CountDown:[function(t,e,n){"use strict";cc._RF.push(e,"0a3f75uxEhC4bbGM+GymXdT","CountDown");var a=t("../api/Ws"),o=t("Global");cc.Class({extends:cc.Component,properties:{CountDownLabel:cc.Label,bankerCard:cc.Node,playerCard:{default:[],type:cc.Node}},onLoad:function(){var t=this;a.on("CountDownStart",function(e){e.status<=0||(t.CountDownLabel.string=e.left>0?e.left:"",t.playerCard.forEach(function(t){t.removeAllChildren()}),t.bankerCard.removeAllChildren(),o.playerCards=[[],[],[],[],[]],o.bankerCards=[])}),a.on("CountDownUser",function(e){e.status<1||(t.CountDownLabel.string=e.left>0&&e.left<6?e.left:"")})},start:function(){}}),cc._RF.pop()},{"../api/Ws":"Ws",Global:"Global"}],Global:[function(t,e,n){"use strict";cc._RF.push(e,"bfb4fXQpcNNz5E/tEE7K1bC","Global");var a="";e.exports={setToken:function(t){a=t},getToken:function(){return a}},cc._RF.pop()},{}],HitStand:[function(t,e,n){"use strict";cc._RF.push(e,"c8346zaB6lNCohqTNqBcUJW","HitStand");var a=t("../api/Ws");t("Global");cc.Class({extends:cc.Component,properties:{button:cc.Button,command:cc.String},onLoad:function(){this.button.node.on("click",this.callback,this)},callback:function(t){var e={cmd:this.command};a.send(e)},start:function(){}}),cc._RF.pop()},{"../api/Ws":"Ws",Global:"Global"}],Login:[function(t,e,n){"use strict";cc._RF.push(e,"630e7jFdgBOPbGoEoK4HtYl","Login");var a=t("Global");cc.Class({extends:cc.Component,properties:{},onLoad:function(){a.token=""},start:function(){}}),cc._RF.pop()},{Global:"Global"}],Player:[function(t,e,n){"use strict";cc._RF.push(e,"7f811FaAOtCVawLrt4H/11N","Player");var a=t("../api/Ws");cc.Class({extends:cc.Component,properties:{Player1Label:cc.Label,Player2Label:cc.Label,Player3Label:cc.Label,Player4Label:cc.Label,Player5Label:cc.Label},onLoad:function(){var t=this;a.on("TablePlayer",function(e){1===e.status&&(t.Player1Label.string=e.players[0].name,t.Player2Label.string=e.players[1].name,t.Player3Label.string=e.players[2].name,t.Player4Label.string=e.players[3].name,t.Player5Label.string=e.players[4].name)}),a.on("Turn",function(e){if(1===e.status){var n=new cc.color(255,255,0),a=new cc.color(255,255,255);t.Player1Label.node.color=0===e.index?n:a,t.Player2Label.node.color=1===e.index?n:a,t.Player3Label.node.color=2===e.index?n:a,t.Player4Label.node.color=3===e.index?n:a,t.Player5Label.node.color=4===e.index?n:a}})},start:function(){}}),cc._RF.pop()},{"../api/Ws":"Ws"}],Table:[function(t,e,n){"use strict";cc._RF.push(e,"bf81cj59KZJHINX0I7Q3HDl","Table");var a=t("../api/Api"),o=t("Global"),c=t("../api/Ws");cc.Class({extends:cc.Component,properties:{balanceLabel:{default:null,type:cc.Label},amountLabel:{default:null,type:cc.Label},labelB:{default:null,type:cc.Label},label1:{default:null,type:cc.Label},label2:{default:null,type:cc.Label},label3:{default:null,type:cc.Label},label4:{default:null,type:cc.Label},label5:{default:null,type:cc.Label}},onLoad:function(){var t=this;o.balance||(o.balance=0),o.tableIndex||(o.tableIndex=0),o.position||(o.position=0),this.getBalance(),c.on("Join",function(e){e.status<=0&&(o.position++,o.position<5&&t.join())}),c.on("Table",function(t){-20==t.status&&cc.director.loadScene("login")}),c.on("NewGame",function(e){1==e.status&&(t.amountLabel.string="0",t.getBalance())}),this.join()},getBalance:function(){a.post("balance",{}).then(function(t){200==t.code&&(o.balance=t.data.balance)}).catch(function(t){console.log(t)})},join:function(){var t={cmd:"Join",table:0,position:o.position};c.send(t)},update:function(t){this.balanceLabel.string=o.balance}}),cc._RF.pop()},{"../api/Api":"Api","../api/Ws":"Ws",Global:"Global"}],Ws:[function(t,e,n){"use strict";cc._RF.push(e,"a7d68UrhRFFxrwf7h2zPKty","Ws");var a,o,c=t("Global"),i="wss://blackjack21.hopto.org/v1/play",r={};function l(){!c.token||c.token.length<=0||a.send(JSON.stringify({cmd:"Table",table:0}))}(function t(){(a=new WebSocket(i)).onopen=function(){console.log("open connection"),o=setInterval(l,1e3)},a.onclose=function(){console.log("close connection"),setTimeout(function(){t()},1e3),clearInterval(o)},a.onmessage=function(t){console.log(t);var e=JSON.parse(t.data);r[e.cmd]&&r[e.cmd](e)}})(),e.exports={on:function(t,e){r[t]=e},send:function(t){t.token=c.token,a.send(JSON.stringify(t))}},cc._RF.pop()},{Global:"Global"}]},{},["Api","Global","Ws","BtnLogin","BtnRegister","Login","Bet","Card","CardPic","CountDown","HitStand","Player","Table"]);