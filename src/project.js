window.__require=function e(t,n,a){function o(i,l){if(!n[i]){if(!t[i]){var r=i.split("/");if(r=r[r.length-1],!t[r]){var s="function"==typeof __require&&__require;if(!l&&s)return s(r,!0);if(c)return c(r,!0);throw new Error("Cannot find module '"+i+"'")}}var u=n[i]={exports:{}};t[i][0].call(u.exports,function(e){return o(t[i][1][e]||e)},u,u.exports,e,t,n,a)}return n[i].exports}for(var c="function"==typeof __require&&__require,i=0;i<a.length;i++)o(a[i]);return o}({Api:[function(e,t,n){"use strict";cc._RF.push(t,"5ba8060fsVLq4GR27vA3rnI","Api");var a=e("Global"),o=e("./config").apiUrl;t.exports={post:function(e,t){t.token=a.token?a.token:"";var n={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)};return fetch(""+o+e,n).then(function(e){return e.json()})}},cc._RF.pop()},{"./config":"Config",Global:"Global"}],Bet:[function(e,t,n){"use strict";cc._RF.push(t,"e7be51jipBB35qq8X7MlHOf","Bet");var a=e("../api/Ws"),o=e("Global");cc.Class({extends:cc.Component,properties:{balanceLabel:{default:null,type:cc.Label},amountLabel:{default:null,type:cc.Label},button:cc.Button,bet:cc.Integer},onLoad:function(){this.button.node.on("click",this.callback,this)},callback:function(e){var t=parseInt(this.bet);if(!(o.balance<t)){o.balance=o.balance-t;var n=parseInt(this.amountLabel.string)+t;this.amountLabel.string=n;var c={cmd:"Bet",betAmount:n};a.send(c)}},start:function(){}}),cc._RF.pop()},{"../api/Ws":"Ws",Global:"Global"}],BtnLogin:[function(e,t,n){"use strict";cc._RF.push(t,"672544/yr1DLqZNjbUZB1/+","BtnLogin");var a=e("../api/Api"),o=e("Global");cc.Class({extends:cc.Component,properties:{username:{default:null,type:cc.EditBox},password:{default:null,type:cc.EditBox},button:cc.Button},onLoad:function(){this.button.node.on("click",this.callback,this)},callback:function(e){e.detail;var t={username:this.username.string,password:this.password.string};a.post("login",t).then(function(e){200==e.code&&(o.token=e.data.token,cc.director.loadScene("table"))}).catch(function(e){console.log(e)})},start:function(){}}),cc._RF.pop()},{"../api/Api":"Api",Global:"Global"}],BtnRegister:[function(e,t,n){"use strict";cc._RF.push(t,"e8bc1ANtv1JGLuBA2ofuptw","BtnRegister");var a=e("../api/Api"),o=e("Global");cc.Class({extends:cc.Component,properties:{username:{default:null,type:cc.EditBox},password:{default:null,type:cc.EditBox},button:cc.Button},onLoad:function(){this.button.node.on("click",this.callback,this)},callback:function(e){e.detail;var t={username:this.username.string,password:this.password.string};a.post("register",t).then(function(e){200==e.code&&(o.token=e.data.token,cc.director.loadScene("table"))}).catch(function(e){console.log(e)})},start:function(){}}),cc._RF.pop()},{"../api/Api":"Api",Global:"Global"}],CardPic:[function(e,t,n){"use strict";cc._RF.push(t,"679e4uEbBJGdYeVm1r3XJMv","CardPic"),cc.Class({extends:cc.Component,properties:{point:cc.Label,suit:cc.Sprite,mainPic:cc.Sprite,cardBG:cc.Sprite,redTextColor:cc.Color.WHITE,blackTextColor:cc.Color.WHITE,texFrontBG:cc.SpriteFrame,texBackBG:cc.SpriteFrame,texFaces:{default:[],type:cc.SpriteFrame},texSuitBig:{default:[],type:cc.SpriteFrame},texSuitSmall:{default:[],type:cc.SpriteFrame}},init:function(e){var t=e.point>10;this.mainPic.spriteFrame=t?this.texFaces[e.point-10-1]:this.texSuitBig[e.suit],this.point.string=e.pointName,e.isRedSuit?this.point.node.color=this.redTextColor:this.point.node.color=this.blackTextColor,this.suit.spriteFrame=this.texSuitSmall[e.suit]},reveal:function(e){this.point.node.active=e,this.suit.node.active=e,this.mainPic.node.active=e,this.cardBG.spriteFrame=e?this.texFrontBG:this.texBackBG}}),cc._RF.pop()},{}],Card:[function(e,t,n){"use strict";cc._RF.push(t,"ecd42aIDKJEu48PnoPuwXKn","Card");var a=e("../api/Ws"),o=e("Global"),c={H:1,D:3,S:0,C:2},i=["","A","2","3","4","5","6","7","8","9","10","J","Q","K"];cc.Class({extends:cc.Component,properties:{cardPrefab:cc.Prefab,playerAnchors:{default:[],type:cc.Node},bankerAnchor:cc.Node,winLabel:cc.Label,looseLabel:cc.Label},onLoad:function(){var e=this;o.playerCards=[[],[],[],[],[]],o.bankerCards=[],a.on("Deal",function(t){1===t.status&&(t.player<0?o.bankerCards.push(t.card):o.playerCards[t.player].push(t.card),e.drawPlayerCard(),e.drawBankerCard())}),a.on("Result",function(t){1===t.status&&(t.result.forEach(function(t){t.player>=0?o.playerCards[t.player]=t.cards:o.bankerCards=t.cards,t.player==o.position&&(e.winLabel.node.active=t.win,e.looseLabel.node.active=!t.win)}),e.drawPlayerCard(),e.drawBankerCard())})},drawPlayerCard:function(){for(var e=0;e<o.playerCards.length;e++){var t={point:0,pointName:1,isRedSuit:1,suit:0};this.playerAnchors[e].removeAllChildren();for(var n=0;n<o.playerCards[e].length;n++){var a=o.playerCards[e][n];if("*"!=a){var l=a.substring(0,1),r=parseInt(a.substring(1));t={point:r,pointName:i[r],isRedSuit:c[l]%2==1,suit:c[l]}}var s=cc.instantiate(this.cardPrefab);this.playerAnchors[e].addChild(s),s.position=cc.v2(20*n,-25*n);var u=s.getComponent("CardPic");u.init(t),u.reveal("*"!=a)}}},drawBankerCard:function(){var e={point:0,pointName:1,isRedSuit:1,suit:0};this.bankerAnchor.removeAllChildren();for(var t=0;t<o.bankerCards.length;t++){var n=o.bankerCards[t];if("*"!=n){var a=n.substring(0,1),l=parseInt(n.substring(1));e={point:l,pointName:i[l],isRedSuit:c[a]%2==1,suit:c[a]}}var r=cc.instantiate(this.cardPrefab);this.bankerAnchor.addChild(r),r.position=cc.v2(50*t,0);var s=r.getComponent("CardPic");s.init(e),s.reveal("*"!=n)}},update:function(e){}}),cc._RF.pop()},{"../api/Ws":"Ws",Global:"Global"}],Config:[function(e,t,n){"use strict";cc._RF.push(t,"cebb6WYYONN8p4luDqpJd5v","Config");t.exports={apiUrl:"https://demogameserver.ddns.net/v1/",webSocketUrl:"wss://demogameserver.ddns.net/v1/baccarat"},cc._RF.pop()},{}],CountDown:[function(e,t,n){"use strict";cc._RF.push(t,"0a3f75uxEhC4bbGM+GymXdT","CountDown");var a=e("../api/Ws"),o=e("Global");cc.Class({extends:cc.Component,properties:{CountDownLabel:cc.Label,bankerCard:cc.Node,playerCard:{default:[],type:cc.Node},winLabel:cc.Label,looseLabel:cc.Label},onLoad:function(){var e=this;a.on("CountDownStart",function(t){t.status<=0||(e.CountDownLabel.string=t.left>0?t.left:"",e.playerCard.forEach(function(e){e.removeAllChildren()}),e.bankerCard.removeAllChildren(),o.playerCards=[[],[],[],[],[]],o.bankerCards=[],e.winLabel.node.active=!1,e.looseLabel.node.active=!1)}),a.on("CountDownUser",function(t){t.status<1||(e.CountDownLabel.string=t.left>0&&t.left<6?t.left:"")})},start:function(){}}),cc._RF.pop()},{"../api/Ws":"Ws",Global:"Global"}],Global:[function(e,t,n){"use strict";cc._RF.push(t,"bfb4fXQpcNNz5E/tEE7K1bC","Global");var a="";t.exports={setToken:function(e){a=e},getToken:function(){return a}},cc._RF.pop()},{}],HitStand:[function(e,t,n){"use strict";cc._RF.push(t,"c8346zaB6lNCohqTNqBcUJW","HitStand");var a=e("../api/Ws");e("Global");cc.Class({extends:cc.Component,properties:{button:cc.Button,command:cc.String},onLoad:function(){this.button.node.on("click",this.callback,this)},callback:function(e){var t={cmd:this.command};a.send(t)},start:function(){}}),cc._RF.pop()},{"../api/Ws":"Ws",Global:"Global"}],Login:[function(e,t,n){"use strict";cc._RF.push(t,"630e7jFdgBOPbGoEoK4HtYl","Login");var a=e("Global");cc.Class({extends:cc.Component,properties:{},onLoad:function(){a.token=""},start:function(){}}),cc._RF.pop()},{Global:"Global"}],Player:[function(e,t,n){"use strict";cc._RF.push(t,"7f811FaAOtCVawLrt4H/11N","Player");var a=e("../api/Ws");cc.Class({extends:cc.Component,properties:{Player1Label:cc.Label,Player2Label:cc.Label,Player3Label:cc.Label,Player4Label:cc.Label,Player5Label:cc.Label},onLoad:function(){var e=this;a.on("TablePlayer",function(t){1===t.status&&(e.Player1Label.string=t.players[0].name,e.Player2Label.string=t.players[1].name,e.Player3Label.string=t.players[2].name,e.Player4Label.string=t.players[3].name,e.Player5Label.string=t.players[4].name)}),a.on("Turn",function(t){if(1===t.status){var n=new cc.color(255,255,0),a=new cc.color(255,255,255);e.Player1Label.node.color=0===t.index?n:a,e.Player2Label.node.color=1===t.index?n:a,e.Player3Label.node.color=2===t.index?n:a,e.Player4Label.node.color=3===t.index?n:a,e.Player5Label.node.color=4===t.index?n:a}})},start:function(){}}),cc._RF.pop()},{"../api/Ws":"Ws"}],Table:[function(e,t,n){"use strict";cc._RF.push(t,"bf81cj59KZJHINX0I7Q3HDl","Table");var a=e("../api/Api"),o=e("Global"),c=e("../api/Ws");cc.Class({extends:cc.Component,properties:{balanceLabel:{default:null,type:cc.Label},amountLabel:{default:null,type:cc.Label},labelB:{default:null,type:cc.Label},label1:{default:null,type:cc.Label},label2:{default:null,type:cc.Label},label3:{default:null,type:cc.Label},label4:{default:null,type:cc.Label},label5:{default:null,type:cc.Label}},onLoad:function(){var e=this;o.balance||(o.balance=0),o.tableIndex||(o.tableIndex=0),o.position||(o.position=0),this.getBalance(),c.on("Join",function(t){t.status<=0&&(o.position++,o.position<5&&e.join())}),c.on("Table",function(e){-20==e.status&&(c.reset(),cc.director.loadScene("login"))}),c.on("NewGame",function(t){1==t.status&&(e.amountLabel.string="0",e.getBalance())}),this.join()},getBalance:function(){a.post("balance",{}).then(function(e){200==e.code&&(o.balance=e.data.balance)}).catch(function(e){console.log(e)})},join:function(){var e={cmd:"Join",table:0,position:o.position};c.send(e)},update:function(e){this.balanceLabel.string=o.balance}}),cc._RF.pop()},{"../api/Api":"Api","../api/Ws":"Ws",Global:"Global"}],Ws:[function(e,t,n){"use strict";cc._RF.push(t,"a7d68UrhRFFxrwf7h2zPKty","Ws");var a,o,c,i=e("Global"),l=e("./config").webSocketUrl,r={};function s(){!i.token||i.token.length<=0||a.send(JSON.stringify({cmd:"Table",token:i.token,table:0}))}(function e(){i.token||""==i.token||setTimeout(function(){e()},1e3),(a=new WebSocket(l)).onopen=function(){console.log("connection open"),clearInterval(o),clearTimeout(c),c=setTimeout(function(){o=setInterval(s,1500)},2e3)},a.onclose=function(){console.log("close connection"),setTimeout(function(){e()},1e3),clearInterval(o),clearTimeout(c)},a.onmessage=function(e){console.log(e);var t=JSON.parse(e.data);r[t.cmd]&&r[t.cmd](t)}})(),t.exports={on:function(e,t){r[e]=t},send:function(e){e.token=i.token,a.send(JSON.stringify(e))},reset:function(){r={}}},cc._RF.pop()},{"./config":"Config",Global:"Global"}]},{},["Api","Config","Global","Ws","BtnLogin","BtnRegister","Login","Bet","Card","CardPic","CountDown","HitStand","Player","Table"]);